---
export const prerender = true;

import Layout from '../layouts/Layout.astro';
import { sanityClient } from 'sanity:client';
import imageUrlBuilder from '@sanity/image-url';

const builder = imageUrlBuilder(sanityClient);

function urlFor(source) {
  return builder.image(source);
}

// Fetch latest posts from Sanity
const latestPosts = await sanityClient.fetch(`*[_type == "post"] | order(publishedAt desc)[0...6] {
  _id,
  title,
  slug,
  excerpt,
  mainImage,
  publishedAt,
  category->{title, slug}
}`);

// Fetch categories
const categories = await sanityClient.fetch(`*[_type == "category"] | order(title asc) {
  title,
  slug,
  description,
  _id
}`);

// Fetch featured posts
const featuredPosts = await sanityClient.fetch(`*[_type == "post" && featured == true] | order(publishedAt desc)[0...3] {
  _id,
  title,
  slug,
  excerpt,
  mainImage,
  category->{title}
}`);
---

<Layout 
  title="Relocation Quest - Global Living, Golden Visas & International Tax Optimization"
  description="Expert guidance on international relocation, Golden Visa programs, tax optimization, and building your dream life abroad. Comprehensive guides for Cyprus, Portugal, Dubai, Malta, Singapore & more."
  keywords="international relocation, golden visa, tax optimization, digital nomad visa, international living, expat guide, residency programs, citizenship by investment"
  image="/images/relocation-quest-hero.jpg"
  imageAlt="Relocation Quest - Your Guide to Global Living and International Relocation"
  type="website"
>
  <!-- Hero component temporarily disabled for debugging -->
  <div class="min-h-screen bg-gradient-to-br from-blue-600 to-orange-500 flex items-center justify-center">
    <div class="text-center text-white">
      <h1 class="text-6xl font-bold mb-4">Your Journey to Global Living Starts Here</h1>
      <p class="text-xl mb-8">Expert guidance on international relocation, visa applications, tax optimization, and building your dream life abroad.</p>
      <a href="/articles" class="bg-white text-blue-600 px-8 py-4 rounded-full font-semibold hover:bg-gray-100 transition-colors">
        Read Latest Articles
      </a>
    </div>
  </div>

  <!-- Features Section -->
  <section class="py-16 bg-white">
    <div class="max-w-7xl mx-auto px-4 sm:px-6">
      <div class="text-center mb-12">
        <h2 class="text-4xl font-bold mb-4">Why Choose Relocation Quest?</h2>
        <p class="text-xl text-gray-600 max-w-2xl mx-auto">Comprehensive resources and expert guidance for your international move</p>
      </div>
      
      <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
        <div class="text-center p-6">
          <div class="w-16 h-16 mx-auto mb-4 flex items-center justify-center">
            <svg class="w-10 h-10 text-blue-600" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M4 4a2 2 0 00-2 2v4a2 2 0 002 2V6h10a2 2 0 00-2-2H4zm2 6a2 2 0 012-2h8a2 2 0 012 2v4a2 2 0 01-2 2H8a2 2 0 01-2-2v-4zm6 4a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd" />
            </svg>
          </div>
          <h3 class="text-xl font-bold mb-3">Golden Visa Programs</h3>
          <p class="text-gray-600">Navigate investment residency programs in Cyprus, Portugal, Malta, and more. Get expert guidance on requirements and benefits.</p>
        </div>
        <div class="text-center p-6">
          <div class="w-16 h-16 mx-auto mb-4 flex items-center justify-center">
            <svg class="w-10 h-10 text-green-600" fill="currentColor" viewBox="0 0 20 20">
              <path d="M8 5a1 1 0 100 2v6h1V7a1 1 0 001-1V6a1 1 0 00-1-1zm2 13a1 1 0 100-2v-6H9v6a1 1 0 001 1z"/>
              <path fill-rule="evenodd" d="M5 2a1 1 0 011 1v1h1a1 1 0 010 2H6v1a1 1 0 01-2 0V6H3a1 1 0 010-2h1V3a1 1 0 011-1zm0 10a1 1 0 011 1v1h1a1 1 0 110 2H6v1a1 1 0 11-2 0v-1H3a1 1 0 110-2h1v-1a1 1 0 011-1z" clip-rule="evenodd"/>
            </svg>
          </div>
          <h3 class="text-xl font-bold mb-3">Tax Optimization</h3>
          <p class="text-gray-600">Understand international tax planning, non-dom status, and how to legally minimize your tax burden abroad.</p>
        </div>
        <div class="text-center p-6">
          <div class="w-16 h-16 mx-auto mb-4 flex items-center justify-center">
            <svg class="w-10 h-10 text-purple-600" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M3 5a2 2 0 012-2h10a2 2 0 012 2v8a2 2 0 01-2 2h-2.22l.123.489.804.804A1 1 0 0113 18H7a1 1 0 01-.707-1.707l.804-.804L7.22 15H5a2 2 0 01-2-2V5zm5.771 7H5V5h10v7H8.771z" clip-rule="evenodd" />
            </svg>
          </div>
          <h3 class="text-xl font-bold mb-3">Digital Nomad Visas</h3>
          <p class="text-gray-600">Discover countries offering remote work visas and learn how to work from paradise legally.</p>
        </div>
        <div class="text-center p-6">
          <div class="w-16 h-16 mx-auto mb-4 flex items-center justify-center">
            <svg class="w-10 h-10 text-indigo-600" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M4 4a2 2 0 012-2h8a2 2 0 012 2v12a1 1 0 110 2h-3a1 1 0 01-1-1v-2a1 1 0 00-1-1H9a1 1 0 00-1 1v2a1 1 0 01-1 1H4a1 1 0 110-2V4zm3 1h2v2H7V5zm2 4H7v2h2V9zm2-4h2v2h-2V5zm2 4h-2v2h2V9z" clip-rule="evenodd" />
            </svg>
          </div>
          <h3 class="text-xl font-bold mb-3">Company Formation</h3>
          <p class="text-gray-600">Set up your business in tax-efficient jurisdictions with our comprehensive guides and partner network.</p>
        </div>
        <div class="text-center p-6">
          <div class="w-16 h-16 mx-auto mb-4 flex items-center justify-center">
            <svg class="w-10 h-10 text-emerald-600" fill="currentColor" viewBox="0 0 20 20">
              <path d="M4 4a2 2 0 00-2 2v1h16V6a2 2 0 00-2-2H4z"/>
              <path fill-rule="evenodd" d="M18 9H2v5a2 2 0 002 2h12a2 2 0 002-2V9zM4 13a1 1 0 011-1h1a1 1 0 110 2H5a1 1 0 01-1-1zm5-1a1 1 0 100 2h1a1 1 0 100-2H9z" clip-rule="evenodd"/>
            </svg>
          </div>
          <h3 class="text-xl font-bold mb-3">Banking & Finance</h3>
          <p class="text-gray-600">Open international bank accounts, understand FATCA/CRS requirements, and manage your wealth globally.</p>
        </div>
        <div class="text-center p-6">
          <div class="w-16 h-16 mx-auto mb-4 flex items-center justify-center">
            <svg class="w-10 h-10 text-rose-600" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z" clip-rule="evenodd" />
            </svg>
          </div>
          <h3 class="text-xl font-bold mb-3">Lifestyle & Culture</h3>
          <p class="text-gray-600">From finding schools to understanding healthcare systems, we cover all aspects of expat life.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Latest Articles Section -->
  <section class="py-16 bg-gray-50">
    <div class="max-w-7xl mx-auto px-4 sm:px-6">
      <div class="text-center mb-12">
        <h2 class="text-4xl font-bold mb-4 bg-gradient-primary bg-clip-text text-transparent">
          Latest Relocation Insights
        </h2>
        <p class="text-xl text-gray-600 max-w-2xl mx-auto">
          Stay informed with our latest articles on visas, taxes, and international living
        </p>
      </div>
      
      <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
        {latestPosts.map((post) => (
          <article class="bg-white rounded-xl shadow-soft hover:shadow-xl transition-all group">
            {post.mainImage && (
              <div class="aspect-video overflow-hidden rounded-t-xl">
                <img
                  src={urlFor(post.mainImage).width(600).height(400).url()}
                  alt={post.title}
                  class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"
                  loading="lazy"
                />
              </div>
            )}
            <div class="p-6">
              {post.category && (
                <span class="text-sm text-primary-600 font-medium">
                  {post.category.title}
                </span>
              )}
              <h3 class="text-xl font-bold mt-2 mb-3 group-hover:text-primary-600 transition-colors">
                <a href={`/articles/${post.slug?.current || '#'}`}>
                  {post.title}
                </a>
              </h3>
              <p class="text-gray-600 line-clamp-3 mb-4">
                {post.excerpt}
              </p>
              <a 
                href={`/articles/${post.slug?.current || '#'}`}
                class="inline-flex items-center text-primary-600 hover:text-primary-700 font-medium"
              >
                Read More
                <svg class="ml-2 w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                </svg>
              </a>
            </div>
          </article>
        ))}
      </div>
      
      <div class="text-center mt-12">
        <a 
          href="/articles" 
          class="inline-flex items-center px-8 py-4 bg-gradient-primary text-white rounded-full hover:shadow-glow transform hover:scale-105 transition-all font-semibold text-lg"
        >
          View All Articles
          <svg class="ml-2 w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6" />
          </svg>
        </a>
      </div>
    </div>
  </section>

  <!-- Categories Grid -->
  <section class="py-16">
    <div class="max-w-7xl mx-auto px-4 sm:px-6">
      <div class="text-center mb-12">
        <h2 class="text-4xl font-bold mb-4">Explore by Category</h2>
        <p class="text-xl text-gray-600">Find exactly what you need for your relocation journey</p>
      </div>
      
      <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6">
        {categories.slice(0, 8).map((category) => (
          <a 
            href={`/categories/${category.slug?.current || '#'}`}
            class="group p-6 bg-white rounded-xl shadow-soft hover:shadow-xl transition-all hover:-translate-y-1"
          >
            <div class="w-12 h-12 mb-4 group-hover:scale-110 transition-transform flex items-center justify-center">
              <svg class="w-8 h-8 text-orange-600" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd" />
              </svg>
            </div>
            <h3 class="text-lg font-bold mb-2 group-hover:text-primary-600 transition-colors">
              {category.title}
            </h3>
            <p class="text-gray-600 text-sm">
              {category.description || "Explore articles in this category"}
            </p>
          </a>
        ))}
      </div>
    </div>
  </section>

  <!-- Stats Section -->
  <section class="py-16 bg-blue-600 text-white">
    <div class="max-w-7xl mx-auto px-4 sm:px-6">
      <div class="text-center mb-12">
        <h2 class="text-4xl font-bold mb-4">Trusted by Global Citizens</h2>
      </div>
      
      <div class="grid md:grid-cols-4 gap-8 text-center">
        <div>
          <div class="text-4xl font-bold mb-2">50+</div>
          <div class="text-blue-200">Countries Covered</div>
        </div>
        <div>
          <div class="text-4xl font-bold mb-2">500+</div>
          <div class="text-blue-200">Expert Articles</div>
        </div>
        <div>
          <div class="text-4xl font-bold mb-2">100K+</div>
          <div class="text-blue-200">Monthly Readers</div>
        </div>
        <div>
          <div class="text-4xl font-bold mb-2">24/7</div>
          <div class="text-blue-200">Updated Content</div>
        </div>
      </div>
    </div>
  </section>

  <!-- Popular Destinations Section -->
  <section class="py-16 bg-white">
    <div class="max-w-7xl mx-auto px-4 sm:px-6">
      <div class="text-center mb-12">
        <h2 class="text-4xl font-bold mb-4">Popular Destinations</h2>
        <p class="text-xl text-gray-600 max-w-2xl mx-auto">Discover the best countries for your international move</p>
      </div>
      
      <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
        <div class="bg-gray-50 rounded-xl p-6 hover:shadow-lg transition-shadow">
          <h3 class="text-2xl font-bold mb-3">Cyprus</h3>
          <p class="text-gray-600 mb-4">EU citizenship pathway, non-dom tax benefits, Mediterranean lifestyle, and English-speaking environment.</p>
          <a href="/countries/cyprus" class="text-blue-600 hover:text-blue-700 font-medium">Explore Cyprus →</a>
        </div>
        <div class="bg-gray-50 rounded-xl p-6 hover:shadow-lg transition-shadow">
          <h3 class="text-2xl font-bold mb-3">Portugal</h3>
          <p class="text-gray-600 mb-4">Golden Visa program, NHR tax regime, affordable living, and excellent climate year-round.</p>
          <a href="/countries/portugal" class="text-blue-600 hover:text-blue-700 font-medium">Explore Portugal →</a>
        </div>
        <div class="bg-gray-50 rounded-xl p-6 hover:shadow-lg transition-shadow">
          <h3 class="text-2xl font-bold mb-3">Dubai</h3>
          <p class="text-gray-600 mb-4">Zero income tax, golden visa options, business hub, and world-class infrastructure.</p>
          <a href="/countries/dubai" class="text-blue-600 hover:text-blue-700 font-medium">Explore Dubai →</a>
        </div>
        <div class="bg-gray-50 rounded-xl p-6 hover:shadow-lg transition-shadow">
          <h3 class="text-2xl font-bold mb-3">Malta</h3>
          <p class="text-gray-600 mb-4">EU passport program, English-speaking, favorable tax system, and strategic location.</p>
          <a href="/countries/malta" class="text-blue-600 hover:text-blue-700 font-medium">Explore Malta →</a>
        </div>
        <div class="bg-gray-50 rounded-xl p-6 hover:shadow-lg transition-shadow">
          <h3 class="text-2xl font-bold mb-3">Singapore</h3>
          <p class="text-gray-600 mb-4">Asian business hub, territorial tax system, excellent education, and political stability.</p>
          <a href="/countries/singapore" class="text-blue-600 hover:text-blue-700 font-medium">Explore Singapore →</a>
        </div>
        <div class="bg-gray-50 rounded-xl p-6 hover:shadow-lg transition-shadow">
          <h3 class="text-2xl font-bold mb-3">Caribbean</h3>
          <p class="text-gray-600 mb-4">Citizenship by investment, tax havens, tropical paradise, and fast processing times.</p>
          <a href="/countries/caribbean" class="text-blue-600 hover:text-blue-700 font-medium">Explore Caribbean →</a>
        </div>
      </div>
    </div>
  </section>

  <!-- FAQ Section -->
  <section class="py-16 bg-gray-50">
    <div class="max-w-4xl mx-auto px-4 sm:px-6">
      <div class="text-center mb-12">
        <h2 class="text-4xl font-bold mb-4">Frequently Asked Questions</h2>
        <p class="text-xl text-gray-600">Get answers to common relocation questions</p>
      </div>
      
      <div class="space-y-8">
        <div class="bg-white rounded-lg p-6 shadow-sm">
          <h3 class="text-xl font-bold mb-3">What is a Golden Visa?</h3>
          <p class="text-gray-600">A Golden Visa is a residency-by-investment program that grants residency rights to individuals who make qualifying investments in a country, typically in real estate, government bonds, or business ventures. These programs often lead to permanent residency and citizenship.</p>
        </div>
        <div class="bg-white rounded-lg p-6 shadow-sm">
          <h3 class="text-xl font-bold mb-3">How long does it take to get residency?</h3>
          <p class="text-gray-600">Processing times vary by country and program. Golden Visa applications typically take 2-6 months, while standard residency permits can take 1-3 months. Citizenship through naturalization usually requires 5-10 years of residency.</p>
        </div>
        <div class="bg-white rounded-lg p-6 shadow-sm">
          <h3 class="text-xl font-bold mb-3">What are the tax implications of relocating?</h3>
          <p class="text-gray-600">Tax implications depend on your citizenship, tax residency status, and the country you're moving to. Many countries offer favorable tax regimes for new residents, including non-dom status, territorial taxation, or special expat tax programs.</p>
        </div>
        <div class="bg-white rounded-lg p-6 shadow-sm">
          <h3 class="text-xl font-bold mb-3">Can I work remotely on a tourist visa?</h3>
          <p class="text-gray-600">Generally no. Working remotely on a tourist visa is illegal in most countries. Instead, look for Digital Nomad Visas or remote work permits specifically designed for location-independent workers.</p>
        </div>
        <div class="bg-white rounded-lg p-6 shadow-sm">
          <h3 class="text-xl font-bold mb-3">Which country is best for digital nomads?</h3>
          <p class="text-gray-600">Popular digital nomad destinations include Portugal, Estonia, Dubai, Barbados, and Croatia. Each offers dedicated digital nomad visas with different requirements, costs, and benefits. The best choice depends on your budget, lifestyle preferences, and tax situation.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Call to Action Section -->
  <section class="py-16 bg-gradient-to-r from-blue-600 to-orange-500 text-white">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 text-center">
      <h2 class="text-4xl font-bold mb-4">Ready to Start Your Relocation Journey?</h2>
      <p class="text-xl mb-8 text-blue-100">Get expert guidance and comprehensive resources for your international move</p>
      <a href="/articles" class="inline-block bg-white text-blue-600 px-8 py-4 rounded-full font-semibold hover:bg-gray-100 transition-colors">
        Explore All Articles
      </a>
    </div>
  </section>

  <!-- Footer -->
  <footer class="bg-gray-900 text-white py-12">
    <div class="max-w-7xl mx-auto px-4 sm:px-6">
      <div class="text-center">
        <h3 class="text-2xl font-bold mb-4">Relocation Quest</h3>
        <p class="text-gray-400 mb-8">Your trusted guide to global living and international relocation</p>
        <div class="flex justify-center space-x-8 text-sm">
          <a href="/articles" class="hover:text-blue-400 transition-colors">Articles</a>
          <a href="/categories" class="hover:text-blue-400 transition-colors">Categories</a>
          <a href="/about" class="hover:text-blue-400 transition-colors">About</a>
          <a href="/contact" class="hover:text-blue-400 transition-colors">Contact</a>
        </div>
        <div class="mt-8 pt-8 border-t border-gray-800 text-gray-500 text-sm">
          <p>&copy; 2024 Relocation Quest. All rights reserved.</p>
        </div>
      </div>
    </div>
  </footer>
</Layout>